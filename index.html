<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Labs - LAUC</title>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, #2c3e50, #1a2530);
            color: white;
            padding: 12px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .pcce-logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
            padding-right: 25px;
            border-right: 2px solid rgba(255, 255, 255, 0.2);
        }

        .pcce-logo-img {
            width: 55px;
            height: 55px;
            object-fit: contain;
            border-radius: 8px;
            background-color: white;
            padding: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .pcce-logo-text {
            display: flex;
            flex-direction: column;
        }

        .pcce-logo-text .main {
            font-size: 18px;
            font-weight: 700;
            color: #fff;
            line-height: 1.2;
        }

        .pcce-logo-text .sub {
            font-size: 11px;
            color: #ecf0f1;
            opacity: 0.9;
            margin-top: 2px;
        }

        .virtual-labs-logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .virtual-labs-logo i {
            font-size: 28px;
            color: #3498db;
        }

        .virtual-labs-logo h1 {
            font-size: 24px;
            font-weight: 600;
        }

        .virtual-labs-logo span {
            color: #3498db;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 15px;
        }

        .user-info i {
            font-size: 18px;
            color: #3498db;
        }

        /* Search Bar */
        .search-container {
            background: white;
            padding: 15px 20px;
            border-bottom: 1px solid #e1e5eb;
            display: flex;
            justify-content: flex-end;
        }

        .search-box {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            border: 1px solid #e1e5eb;
            border-radius: 6px;
            padding: 8px 15px;
            width: 300px;
        }

        .search-box input {
            border: none;
            background: transparent;
            padding: 5px;
            width: 100%;
            font-size: 14px;
            outline: none;
        }

        .search-box i {
            color: #7f8c8d;
            margin-right: 8px;
        }

        /* Main Container */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Welcome Section */
        .welcome-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            text-align: center;
            border-left: 4px solid #3498db;
        }

        .welcome-section h2 {
            color: #2c3e50;
            font-size: 24px;
            margin-bottom: 10px;
        }

        .welcome-section p {
            color: #7f8c8d;
            font-size: 16px;
        }

        /* Lab Title Section */
        .lab-title-section {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            border-top: 3px solid #3498db;
        }

        .lab-title-section h2 {
            color: #2c3e50;
            font-size: 28px;
            margin-bottom: 8px;
        }

        .lab-title-section p {
            color: #7f8c8d;
            font-size: 16px;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .option-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            text-align: center;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .option-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            border-color: #3498db;
        }

        .option-card.active {
            background: #e8f4fc;
            border-color: #3498db;
            transform: translateY(-3px);
        }

        .option-card i {
            font-size: 32px;
            color: #3498db;
            margin-bottom: 15px;
        }

        .option-card h3 {
            color: #2c3e50;
            font-size: 18px;
            margin-bottom: 8px;
        }

        .option-card p {
            color: #7f8c8d;
            font-size: 14px;
            line-height: 1.4;
        }

        /* Content Display Area */
        .content-display-area {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
            min-height: 500px;
            border-top: 4px solid #3498db;
            display: none;
        }

        .content-display-area.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .content-header {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e1e5eb;
        }

        .content-header h2 {
            color: #2c3e50;
            font-size: 26px;
            font-weight: 600;
        }

        .content-header p {
            color: #7f8c8d;
            margin-top: 5px;
            font-size: 16px;
        }

        .content-body {
            padding: 20px 0;
        }

        /* Simulation Content Styles */
        .simulation-container {
            padding: 20px 0;
        }

        .simulation-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .simulation-header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2rem;
        }

        .simulation-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        @media (max-width: 1100px) {
            .simulation-grid {
                grid-template-columns: 1fr;
            }
        }

        .simulation-input-panel {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #e1e8f0;
        }

        .simulation-graph-container {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #e1e8f0;
        }

        .simulation-panel-title {
            font-size: 1.3rem;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }

        .simulation-form-group {
            margin-bottom: 15px;
        }

        .simulation-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.95rem;
        }

        .simulation-input {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e1e8f0;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.3s;
            background: white;
        }

        .simulation-input:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .simulation-button-group {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }

        .simulation-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        #simulation-calculate-btn {
            background: #3498db;
            color: white;
        }

        #simulation-calculate-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        #simulation-reset-btn {
            background: #ecf0f1;
            color: #2c3e50;
        }

        #simulation-reset-btn:hover {
            background: #d5dbdb;
            transform: translateY(-2px);
        }

        .simulation-examples {
            margin-top: 20px;
            padding: 15px;
            background: #e8f4fc;
            border-radius: 8px;
        }

        .simulation-examples h4 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .simulation-example-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .simulation-example-btn {
            background: white;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85rem;
            border: 1px solid #e1e8f0;
            transition: all 0.3s;
        }

        .simulation-example-btn:hover {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .simulation-result-section {
            margin-top: 20px;
            padding: 15px;
            background: #e8f4fc;
            border-radius: 8px;
        }

        .simulation-result-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .simulation-taylor-polynomial-box {
            background: white;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #e1e8f0;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            overflow-x: auto;
        }

        #simulation-taylor-result {
            font-size: 1rem;
            color: #2c3e50;
            line-height: 1.5;
        }

        .simulation-value-comparison {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 12px;
        }

        .simulation-value-box {
            background: white;
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid #e1e8f0;
        }

        .simulation-value-label {
            font-size: 0.8rem;
            color: #7b8a8b;
            margin-bottom: 5px;
            display: block;
        }

        .simulation-value-number {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2c3e50;
        }

        #simulation-graph {
            width: 100%;
            height: 400px;
            border-radius: 8px;
            overflow: hidden;
            background: white;
        }

        .simulation-instructions {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e1e8f0;
        }

        .simulation-instructions h4 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .simulation-instructions ul {
            padding-left: 20px;
            color: #5d6d7e;
        }

        .simulation-instructions li {
            margin-bottom: 6px;
            font-size: 0.9rem;
        }

        /* Default content styling */
        .default-content {
            padding: 15px;
            line-height: 1.7;
            color: #5d6d7e;
        }

        .default-content h3 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.3rem;
        }

        .default-content p {
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .default-content ul {
            padding-left: 20px;
            margin-bottom: 15px;
        }

        .default-content li {
            margin-bottom: 6px;
        }

        /* Contributors Table */
        .contributors-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }

        .contributors-table th {
            background-color: #3498db;
            color: white;
            text-align: left;
            padding: 15px;
            font-weight: 600;
        }

        .contributors-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e1e5eb;
        }

        .contributors-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .contributors-table tr:hover {
            background-color: #e8f4fc;
        }

        .contributors-table .guide-row {
            background-color: #fff8e1;
            font-weight: 600;
        }

        .contributors-table .guide-row:hover {
            background-color: #ffecb3;
        }

        .contributors-table .developer-row {
            background-color: white;
        }

        .email-cell {
            font-size: 0.9rem;
            color: #3498db;
            word-break: break-all;
        }

        /* Footer */
        footer {
            background: #2c3e50;
            color: white;
            padding: 25px 20px;
            margin-top: 30px;
            border-top: 3px solid #3498db;
        }

        .footer-container {
            max-width: 1400px;
            margin: 0 auto;
            text-align: center;
        }

        .footer-logo {
            font-weight: bold;
            color: #3498db;
        }

        .footer-info {
            font-size: 14px;
            margin-top: 10px;
            opacity: 0.8;
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .active {
            display: block !important;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            background: #2ecc71;
            color: white;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 10000;
            animation: slideIn 0.3s ease;
            display: none;
        }

        .notification.error {
            background: #e74c3c;
        }

        .notification.info {
            background: #3498db;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* System Status */
        .system-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 12px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .system-status i {
            color: #2ecc71;
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .options-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .simulation-grid {
                grid-template-columns: 1fr;
            }
            
            .contributors-table {
                display: block;
                overflow-x: auto;
            }
        }

        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .logo-section {
                flex-direction: column;
                gap: 15px;
                width: 100%;
            }
            
            .pcce-logo-container {
                border-right: none;
                padding-right: 0;
                border-bottom: 2px solid rgba(255, 255, 255, 0.2);
                padding-bottom: 15px;
                justify-content: center;
                width: 100%;
            }
            
            .virtual-labs-logo {
                justify-content: center;
            }
            
            .options-grid {
                grid-template-columns: 1fr;
            }

            .search-box {
                width: 100%;
                max-width: 400px;
            }
            
            .simulation-value-comparison {
                grid-template-columns: 1fr;
            }
            
            .contributors-table th,
            .contributors-table td {
                padding: 8px 10px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 576px) {
            .pcce-logo-container {
                flex-direction: column;
                text-align: center;
            }
            
            .pcce-logo-img {
                width: 60px;
                height: 60px;
            }

            .simulation-example-buttons {
                flex-direction: column;
            }
            
            .simulation-button-group {
                flex-direction: column;
            }
            
            .contributors-table {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Notification System -->
    <div class="notification" id="notification"></div>

    <!-- System Status -->
    <div class="system-status">
        <i class="fas fa-server"></i>
        <span>ELBWARE: 0.72%</span>
    </div>

    <!-- Header -->
    <header>
        <div class="header-container">
            <div class="logo-section">
                <!-- PCOE Logo -->
                <div class="pcce-logo-container">
                    <img src="https://raw.githubusercontent.com/dineshkute90/virtual_lab_LAUC/main/pccoe.png" 
                         alt="PCOE Logo" 
                         class="pcce-logo-img"
                         id="pcceLogo"
                         onerror="this.onerror=null; this.src='https://via.placeholder.com/55x55/2c3e50/ffffff?text=PCOE';">
                    <div class="pcce-logo-text">
                        <div class="main">APPLIED SCIENCES & HUMANITIES</div>
                        <div class="sub">Pimpri Chinchwad College of Engineering</div>
                    </div>
                </div>
                
                <!-- Virtual Labs Logo -->
                <div class="virtual-labs-logo">
                    <i class="fas fa-flask"></i>
                    <h1>Virtual <span>Labs</span></h1>
                </div>
            </div>
            
            <div class="user-info">
                <i class="fas fa-user-circle"></i>
                <span>Welcome, Student</span>
            </div>
        </div>
    </header>

    <!-- Search Bar -->
    <div class="search-container">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Search..." id="searchInput">
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Welcome Section -->
        <div class="welcome-section">
            <h2>Welcome, Student</h2>
            <p>Explore interactive virtual lab experiments in Engineering Mathematics</p>
        </div>

        <!-- Lab Title Section -->
        <div class="lab-title-section">
            <h2>A Virtual Lab on Polynomial Expansion Using Taylor's Theorem</h2>
            <p>Engineering Mathematics Experiment</p>
        </div>

        <!-- Options Grid -->
        <div class="options-grid">
            <div class="option-card" data-option="aim">
                <i class="fas fa-bullseye"></i>
                <h3>Aim</h3>
                <p>Objective of the experiment</p>
            </div>
            <div class="option-card" data-option="theory">
                <i class="fas fa-book"></i>
                <h3>Theory</h3>
                <p>Background concepts</p>
            </div>
            <div class="option-card" data-option="pretest">
                <i class="fas fa-question-circle"></i>
                <h3>Pretest</h3>
                <p>Pre-experiment assessment</p>
            </div>
            <div class="option-card" data-option="simulation">
                <i class="fas fa-desktop"></i>
                <h3>Simulation</h3>
                <p>Interactive simulation</p>
            </div>
            <div class="option-card" data-option="posttest">
                <i class="fas fa-clipboard-check"></i>
                <h3>Posttest</h3>
                <p>Post-experiment assessment</p>
            </div>
            <div class="option-card" data-option="references">
                <i class="fas fa-book-open"></i>
                <h3>References</h3>
                <p>Further reading materials</p>
            </div>
            <div class="option-card" data-option="contributors">
                <i class="fas fa-users"></i>
                <h3>Contributors</h3>
                <p>People involved</p>
            </div>
            <div class="option-card" data-option="feedback">
                <i class="fas fa-comment-alt"></i>
                <h3>Feedback</h3>
                <p>Share your experience</p>
            </div>
        </div>

        <!-- Content Display Area -->
        <div class="content-display-area" id="content-display">
            <div class="content-header">
                <h2 id="content-title">Select an option to begin</h2>
                <p id="content-subtitle">Click on any option card above to view its content</p>
            </div>
            
            <div class="content-body" id="content-body">
                <!-- Content will be loaded here dynamically -->
                <div class="default-content" id="default-content">
                    <h3>Welcome to the Polynomial Expansion Virtual Lab</h3>
                    <p>This virtual lab experiment helps you understand Taylor series expansion and polynomial approximation of functions.</p>
                    <p>Please select an option from the cards above to:</p>
                    <ul>
                        <li>Learn about the aim and objectives of this experiment</li>
                        <li>Study the theoretical background</li>
                        <li>Take pre-experiment assessment tests</li>
                        <li>Use the interactive simulation tool</li>
                        <li>Complete post-experiment assessments</li>
                        <li>Access reference materials</li>
                        <li>Learn about contributors</li>
                        <li>Provide feedback on your experience</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <p>Virtual Labs © 2025 | Applied Sciences & Humanities Department | 
               <span class="footer-logo">Pimpri Chinchwad College of Engineering</span>
            </p>
            <p class="footer-info">This virtual lab is part of the Engineering Mathematics curriculum</p>
        </div>
    </footer>

    <script>
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Virtual Lab initialized");
            
            // Initialize option cards
            initializeOptionCards();
            
            // Initialize search functionality
            initializeSearch();
            
            // Initialize notification system
            initializeNotifications();
        });

        // Option Cards Functionality
        function initializeOptionCards() {
            const optionCards = document.querySelectorAll('.option-card');
            const contentDisplay = document.getElementById('content-display');
            const contentTitle = document.getElementById('content-title');
            const contentSubtitle = document.getElementById('content-subtitle');
            const contentBody = document.getElementById('content-body');
            const defaultContent = document.getElementById('default-content');

            optionCards.forEach(card => {
                card.addEventListener('click', function() {
                    const option = this.dataset.option;
                    
                    // Remove active class from all cards
                    optionCards.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked card
                    this.classList.add('active');
                    
                    // Show content display area
                    contentDisplay.classList.add('active');
                    
                    // Hide default content
                    defaultContent.style.display = 'none';
                    
                    // Load content based on option
                    loadContent(option, contentTitle, contentSubtitle, contentBody);
                    
                    // Initialize simulation if that option is selected
                    if (option === 'simulation') {
                        setTimeout(initializeSimulation, 100);
                    }
                });
            });
        }

        // Load Content Function
        function loadContent(option, titleElement, subtitleElement, bodyElement) {
            let title = '';
            let subtitle = '';
            let contentHTML = '';

            switch(option) {
                case 'aim':
                    title = 'Aim of the Experiment';
                    subtitle = 'Objectives and learning outcomes';
                    contentHTML = `
                        <div class="default-content">
                            <h3>Aim of the Experiment</h3>
                            <p>To understand and visualize the concept of Taylor series expansion for approximating functions using polynomials.</p>
                            
                            <h4>Objectives</h4>
                            <ul>
                                <li>Understand the mathematical foundation of Taylor's theorem</li>
                                <li>Learn how to calculate Taylor polynomial expansions for various functions</li>
                                <li>Visualize how increasing polynomial degree improves function approximation</li>
                                <li>Explore the relationship between the expansion point and approximation accuracy</li>
                                <li>Compare the original function with its Taylor polynomial approximation</li>
                            </ul>
                            
                            <h4>Learning Outcomes</h4>
                            <p>After completing this experiment, students will be able to:</p>
                            <ul>
                                <li>Explain Taylor's theorem and its significance in function approximation</li>
                                <li>Calculate Taylor polynomials for common functions</li>
                                <li>Analyze the error in Taylor polynomial approximations</li>
                                <li>Apply Taylor series in practical mathematical and engineering problems</li>
                            </ul>
                        </div>
                    `;
                    break;

                case 'theory':
                    title = 'Theory: Taylor\'s Theorem';
                    subtitle = 'Mathematical background and concepts';
                    contentHTML = `
                        <div class="default-content">
                            <h3>Theory: Taylor's Theorem</h3>
                            <p>Taylor's theorem provides a way to approximate functions with polynomials, which is fundamental in calculus and numerical analysis.</p>
                            
                            <h4>Taylor Series Expansion</h4>
                            <p>For a function f(x) that is infinitely differentiable at a point a, the Taylor series is given by:</p>
                            <p style="text-align: center; font-family: 'Cambria Math', serif; font-size: 1.2rem; margin: 20px 0; background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                f(x) = f(a) + f'(a)(x-a) + f''(a)(x-a)²/2! + f'''(a)(x-a)³/3! + ...
                            </p>
                            
                            <h4>Taylor Polynomial</h4>
                            <p>The nth-degree Taylor polynomial is the partial sum of the Taylor series up to the nth term:</p>
                            <p style="text-align: center; font-family: 'Cambria Math', serif; font-size: 1.2rem; margin: 20px 0; background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                Tₙ(x) = Σ_{k=0}^n [f⁽ᵏ⁾(a)(x-a)ᵏ]/k!
                            </p>
                            
                            <h4>Common Taylor Series</h4>
                            <ul>
                                <li><strong>eˣ =</strong> 1 + x + x²/2! + x³/3! + ... (for all x)</li>
                                <li><strong>sin(x) =</strong> x - x³/3! + x⁵/5! - x⁷/7! + ... (for all x)</li>
                                <li><strong>cos(x) =</strong> 1 - x²/2! + x⁴/4! - x⁶/6! + ... (for all x)</li>
                                <li><strong>1/(1-x) =</strong> 1 + x + x² + x³ + ... (for |x| < 1)</li>
                                <li><strong>ln(1+x) =</strong> x - x²/2 + x³/3 - x⁴/4 + ... (for -1 < x ≤ 1)</li>
                            </ul>
                        </div>
                    `;
                    break;

                case 'pretest':
                    title = 'Pre-Test Assessment';
                    subtitle = 'Test your prior knowledge';
                    contentHTML = `
                        <div class="default-content">
                            <h3>Pre-Test Questions</h3>
                            <p>Answer the following questions to assess your prior knowledge about Taylor series and polynomial expansion.</p>
                            
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                                <h4>Question 1</h4>
                                <p>What is the Taylor series expansion of eˣ about x = 0?</p>
                                <div style="margin-left: 20px;">
                                    <p><input type="radio" name="q1" id="q1a"> eˣ = 1 + x + x² + x³ + ...</p>
                                    <p><input type="radio" name="q1" id="q1b"> eˣ = x + x²/2 + x³/6 + x⁴/24 + ...</p>
                                    <p><input type="radio" name="q1" id="q1c"> eˣ = 1 + x + x²/2! + x³/3! + ...</p>
                                    <p><input type="radio" name="q1" id="q1d"> eˣ = 1 - x + x²/2! - x³/3! + ...</p>
                                </div>
                            </div>
                            
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                                <h4>Question 2</h4>
                                <p>What is the third-degree Taylor polynomial for sin(x) about x = 0?</p>
                                <div style="margin-left: 20px;">
                                    <p><input type="radio" name="q2" id="q2a"> T₃(x) = x</p>
                                    <p><input type="radio" name="q2" id="q2b"> T₃(x) = x - x³/6</p>
                                    <p><input type="radio" name="q2" id="q2c"> T₃(x) = 1 - x²/2</p>
                                    <p><input type="radio" name="q2" id="q2d"> T₃(x) = x + x³/6</p>
                                </div>
                            </div>
                            
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                                <h4>Question 3</h4>
                                <p>What is the main purpose of Taylor series expansion?</p>
                                <div style="margin-left: 20px;">
                                    <p><input type="radio" name="q3" id="q3a"> To solve differential equations</p>
                                    <p><input type="radio" name="q3" id="q3b"> To find function roots</p>
                                    <p><input type="radio" name="q3" id="q3c"> To approximate functions with polynomials</p>
                                    <p><input type="radio" name="q3" id="q3d"> To calculate function integrals</p>
                                </div>
                            </div>
                            
                            <button class="simulation-btn" style="background: #3498db; color: white; padding: 12px 30px; border: none; border-radius: 6px; cursor: pointer;" onclick="submitPretest()">
                                <i class="fas fa-paper-plane"></i> Submit Pretest
                            </button>
                        </div>
                    `;
                    break;

                case 'simulation':
                    title = 'Interactive Simulation';
                    subtitle = 'Taylor Polynomial Expansion Visualizer';
                    contentHTML = `
                        <div class="simulation-container">
                            <div class="simulation-header">
                                <h1>Taylor Polynomial Expansion Visualizer</h1>
                                <p style="color: #5d6d7e; max-width: 800px; margin: 0 auto;">Explore function approximations using Taylor series. Input any differentiable function, choose expansion parameters, and visualize the approximation quality.</p>
                            </div>
                            
                            <div class="simulation-grid">
                                <div class="simulation-input-panel">
                                    <h3 class="simulation-panel-title">Function & Parameters</h3>
                                    
                                    <div class="simulation-form-group">
                                        <label class="simulation-label">Function f(x):</label>
                                        <input type="text" id="simulation-function" class="simulation-input" value="sin(x)" placeholder="e.g., sin(x), exp(x), cos(x)">
                                        <p style="font-size: 0.85rem; color: #7b8a8b; margin-top: 5px;">Use: sin(x), cos(x), exp(x), log(1+x), sqrt(x), x^2 for x²</p>
                                    </div>
                                    
                                    <div class="simulation-form-group">
                                        <label class="simulation-label">Expansion Point (a):</label>
                                        <input type="number" id="simulation-expansion-point" class="simulation-input" value="0" step="any">
                                    </div>
                                    
                                    <div class="simulation-form-group">
                                        <label class="simulation-label">Expansion Power (n):</label>
                                        <input type="range" id="simulation-power" min="0" max="10" value="5" class="simulation-input" style="padding: 0;">
                                        <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                                            <span style="font-size: 0.85rem; color: #7b8a8b;">0</span>
                                            <span style="font-weight: 600;" id="simulation-power-value">5</span>
                                            <span style="font-size: 0.85rem; color: #7b8a8b;">10</span>
                                        </div>
                                    </div>
                                    
                                    <div class="simulation-form-group">
                                        <label class="simulation-label">X Range:</label>
                                        <div style="display: flex; gap: 10px;">
                                            <input type="number" id="simulation-x-min" class="simulation-input" value="-3" step="any" placeholder="Min">
                                            <input type="number" id="simulation-x-max" class="simulation-input" value="3" step="any" placeholder="Max">
                                        </div>
                                    </div>
                                    
                                    <div class="simulation-button-group">
                                        <button id="simulation-calculate-btn" class="simulation-btn">Calculate & Graph</button>
                                        <button id="simulation-reset-btn" class="simulation-btn">Reset</button>
                                    </div>
                                    
                                    <div class="simulation-examples">
                                        <h4>Quick Examples</h4>
                                        <div class="simulation-example-buttons">
                                            <button class="simulation-example-btn" data-func="sin(x)" data-point="0" data-power="7" data-xmin="-6" data-xmax="6">sin(x)</button>
                                            <button class="simulation-example-btn" data-func="exp(x)" data-point="0" data-power="5" data-xmin="-2" data-xmax="2">exp(x)</button>
                                            <button class="simulation-example-btn" data-func="cos(x)" data-point="0" data-power="6" data-xmin="-6" data-xmax="6">cos(x)</button>
                                            <button class="simulation-example-btn" data-func="log(1+x)" data-point="0" data-power="6" data-xmin="-0.9" data-xmax="2">log(1+x)</button>
                                            <button class="simulation-example-btn" data-func="1/(1-x)" data-point="0" data-power="8" data-xmin="-1.5" data-xmax="1.5">1/(1-x)</button>
                                        </div>
                                    </div>
                                    
                                    <div class="simulation-result-section">
                                        <h4 class="simulation-result-title">Taylor Polynomial</h4>
                                        <div class="simulation-taylor-polynomial-box">
                                            <div id="simulation-taylor-result">
                                                Enter function and click "Calculate & Graph"
                                            </div>
                                        </div>
                                        
                                        <h4 class="simulation-result-title">Value Comparison at x = <span id="simulation-x-value-display">0.000</span></h4>
                                        <div class="simulation-value-comparison">
                                            <div class="simulation-value-box">
                                                <span class="simulation-value-label">Original Function</span>
                                                <span class="simulation-value-number" id="simulation-original-value">-</span>
                                            </div>
                                            <div class="simulation-value-box">
                                                <span class="simulation-value-label">Taylor Approximation</span>
                                                <span class="simulation-value-number" id="simulation-taylor-value">-</span>
                                            </div>
                                            <div class="simulation-value-box">
                                                <span class="simulation-value-label">Difference</span>
                                                <span class="simulation-value-number" id="simulation-difference">-</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="simulation-graph-container">
                                    <h3 class="simulation-panel-title">Visualization</h3>
                                    <div id="simulation-graph"></div>
                                    
                                    <div class="simulation-instructions">
                                        <h4>How to Use</h4>
                                        <ul>
                                            <li>Enter a mathematical function using JavaScript syntax</li>
                                            <li>Specify the expansion point (a) and highest power (n)</li>
                                            <li>Adjust the X range to focus on the region of interest</li>
                                            <li>Click "Calculate & Graph" to generate the Taylor polynomial</li>
                                            <li>Try the example functions for quick demonstrations</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'posttest':
                    title = 'Post-Test Assessment';
                    subtitle = 'Test your understanding after the experiment';
                    contentHTML = `
                        <div class="default-content">
                            <h3>Post-Test Questions</h3>
                            <p>Answer the following questions to assess your understanding after completing the simulation.</p>
                            
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                                <h4>Question 1</h4>
                                <p>What happens to the Taylor polynomial approximation error as you increase the degree n?</p>
                                <div style="margin-left: 20px;">
                                    <p><input type="radio" name="pq1" id="pq1a"> The error always increases</p>
                                    <p><input type="radio" name="pq1" id="pq1b"> The error remains constant</p>
                                    <p><input type="radio" name="pq1" id="pq1c"> The error generally decreases near the expansion point</p>
                                    <p><input type="radio" name="pq1" id="pq1d"> The error becomes unpredictable</p>
                                </div>
                            </div>
                            
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                                <h4>Question 2</h4>
                                <p>For which of these functions does the Maclaurin series (a=0) converge for all x?</p>
                                <div style="margin-left: 20px;">
                                    <p><input type="radio" name="pq2" id="pq2a"> sin(x) and cos(x)</p>
                                    <p><input type="radio" name="pq2" id="pq2b"> 1/(1-x)</p>
                                    <p><input type="radio" name="pq2" id="pq2c"> ln(1+x)</p>
                                    <p><input type="radio" name="pq2" id="pq2d"> All of the above</p>
                                </div>
                            </div>
                            
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                                <h4>Question 3</h4>
                                <p>What is the main application of Taylor series in engineering?</p>
                                <div style="margin-left: 20px;">
                                    <p><input type="radio" name="pq3" id="pq3a"> Solving electrical circuits</p>
                                    <p><input type="radio" name="pq3" id="pq3b"> Structural analysis</p>
                                    <p><input type="radio" name="pq3" id="pq3c"> Function approximation in numerical methods</p>
                                    <p><input type="radio" name="pq3" id="pq3d"> Fluid dynamics calculations</p>
                                </div>
                            </div>
                            
                            <button class="simulation-btn" style="background: #3498db; color: white; padding: 12px 30px; border: none; border-radius: 6px; cursor: pointer;" onclick="submitPosttest()">
                                <i class="fas fa-paper-plane"></i> Submit Posttest
                            </button>
                        </div>
                    `;
                    break;

                case 'references':
                    title = 'References';
                    subtitle = 'Further reading materials';
                    contentHTML = `
                        <div class="default-content">
                            <h3>References</h3>
                            
                            <h4>Textbooks</h4>
                            <ul>
                                <li>Thomas, G. B., et al. "Thomas' Calculus." Pearson Education, 14th Edition</li>
                                <li>Stewart, J. "Calculus: Early Transcendentals." Cengage Learning, 8th Edition</li>
                                <li>Kreyszig, E. "Advanced Engineering Mathematics." Wiley, 10th Edition</li>
                                <li>Chapra, S. C., & Canale, R. P. "Numerical Methods for Engineers." McGraw-Hill, 7th Edition</li>
                            </ul>
                            
                            <h4>Online Resources</h4>
                            <ul>
                                <li>Khan Academy: Taylor and Maclaurin series</li>
                                <li>MIT OpenCourseWare: Single Variable Calculus</li>
                                <li>Wolfram MathWorld: Taylor Series</li>
                                <li>Paul's Online Math Notes: Calculus II - Taylor Series</li>
                            </ul>
                            
                            <h4>Additional Reading</h4>
                            <ul>
                                <li>Weisstein, Eric W. "Taylor Series." From MathWorld</li>
                                <li>Strang, G. "Calculus." Wellesley-Cambridge Press</li>
                                <li>Boas, M. L. "Mathematical Methods in the Physical Sciences." Wiley</li>
                            </ul>
                        </div>
                    `;
                    break;

                case 'contributors':
                    title = 'Contributors';
                    subtitle = 'People involved in creating this virtual lab';
                    contentHTML = `
                        <div class="default-content">
                            <h3>Contributors</h3>
                            <p>This virtual lab on Polynomial Expansion using Taylor's Theorem was developed under the guidance of faculty and by a team of dedicated students from the Department of Applied Sciences & Humanities.</p>
                            
                            <h4>Faculty Guidance</h4>
                            <table class="contributors-table">
                                <thead>
                                    <tr>
                                        <th>Role</th>
                                        <th>Name</th>
                                        <th>Department</th>
                                        <th>Institution</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="guide-row">
                                        <td>Guide & Supervisor</td>
                                        <td><strong>Prof. Dinesh Kute</strong></td>
                                        <td>Applied Sciences & Humanities</td>
                                        <td>Pimpri Chinchwad College of Engineering</td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <h4 style="margin-top: 30px;">Development Team</h4>
                            <table class="contributors-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>PRN</th>
                                        <th>Email</th>
                                        <th>Role</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="developer-row">
                                        <td><strong>Swastik Sandipkumar Phapale</strong></td>
                                        <td>125B1F212</td>
                                        <td class="email-cell">swastik.phapale25@pccoepune.org</td>
                                        <td>Lead Developer</td>
                                    </tr>
                                    <tr class="developer-row">
                                        <td><strong>Pratik Deepak Phapale</strong></td>
                                        <td>125B1F210</td>
                                        <td class="email-cell">pratik.phapale25@pccoepune.org</td>
                                        <td>Backend Developer</td>
                                    </tr>
                                    <tr class="developer-row">
                                        <td><strong>Sarthak Pravin Gandhi</strong></td>
                                        <td>125B1F201</td>
                                        <td class="email-cell">sarthak.gandhi25@pccoepune.org</td>
                                        <td>Frontend Developer</td>
                                    </tr>
                                    <tr class="developer-row">
                                        <td><strong>Swapnil Arjun Jadhav</strong></td>
                                        <td>125B1F211</td>
                                        <td class="email-cell">swapnil.jadhav25@pccoepune.org</td>
                                        <td>Testing & Documentation</td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <h4 style="margin-top: 30px;">Acknowledgements</h4>
                            <ul>
                                <li>Department of Applied Sciences & Humanities, Pimpri Chinchwad College of Engineering</li>
                                <li>Virtual Labs Initiative, Ministry of Education, Government of India</li>
                                <li>All faculty members for their valuable feedback and suggestions</li>
                            </ul>
                            
                            <h4 style="margin-top: 30px;">Contact Information</h4>
                            <p>For queries and feedback about this virtual lab, please contact:</p>
                            <p><strong>Email:</strong> virtuallabs@pcce.edu.in<br>
                            <strong>Department:</strong> Applied Sciences & Humanities<br>
                            <strong>Institution:</strong> Pimpri Chinchwad College of Engineering</p>
                        </div>
                    `;
                    break;

                case 'feedback':
                    title = 'Feedback';
                    subtitle = 'Share your experience with us';
                    contentHTML = `
                        <div class="default-content">
                            <h3>Feedback</h3>
                            <p>Your feedback is valuable to us! Please share your experience with this virtual lab experiment.</p>
                            <p>We appreciate your comments and suggestions for improvement.</p>
                            
                            <div style="margin: 25px 0;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">Overall Experience</label>
                                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                                    <button class="feedback-rating" data-rating="1">★</button>
                                    <button class="feedback-rating" data-rating="2">★</button>
                                    <button class="feedback-rating" data-rating="3">★</button>
                                    <button class="feedback-rating" data-rating="4">★</button>
                                    <button class="feedback-rating active" data-rating="5">★</button>
                                </div>
                                
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">Comments</label>
                                <textarea id="feedback-comments" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; min-height: 100px; font-family: inherit;" placeholder="Please share your thoughts about this virtual lab..."></textarea>
                            </div>
                            
                            <button class="simulation-btn" style="background: #3498db; color: white; padding: 12px 30px; border: none; border-radius: 6px; cursor: pointer;" onclick="submitFeedback()">
                                <i class="fas fa-paper-plane"></i> Submit Feedback
                            </button>
                        </div>
                    `;
                    break;
            }

            // Update content
            titleElement.textContent = title;
            subtitleElement.textContent = subtitle;
            bodyElement.innerHTML = contentHTML;
            
            // Initialize feedback ratings if in feedback section
            if (option === 'feedback') {
                initializeFeedbackRatings();
            }
        }

        // Search Functionality
        function initializeSearch() {
            const searchInput = document.getElementById('searchInput');
            const optionCards = document.querySelectorAll('.option-card');
            
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase().trim();
                
                optionCards.forEach(card => {
                    const cardTitle = card.querySelector('h3').textContent.toLowerCase();
                    const cardDesc = card.querySelector('p').textContent.toLowerCase();
                    
                    if (searchTerm === '' || cardTitle.includes(searchTerm) || cardDesc.includes(searchTerm)) {
                        card.style.display = 'flex';
                    } else {
                        card.style.display = 'none';
                    }
                });
            });
        }

        // Notification System
        function initializeNotifications() {
            window.showNotification = function(message, type = 'info') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type}`;
                notification.style.display = 'block';
                
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            };
        }

        // Pretest Submission
        function submitPretest() {
            let score = 0;
            if (document.getElementById('q1c')?.checked) score++;
            if (document.getElementById('q2b')?.checked) score++;
            if (document.getElementById('q3c')?.checked) score++;
            
            showNotification(`Pretest submitted! You scored ${score}/3.`, 'info');
        }

        // Posttest Submission
        function submitPosttest() {
            let score = 0;
            if (document.getElementById('pq1c')?.checked) score++;
            if (document.getElementById('pq2a')?.checked) score++;
            if (document.getElementById('pq3c')?.checked) score++;
            
            showNotification(`Posttest submitted! You scored ${score}/3.`, 'info');
        }

        // Feedback Submission
        function submitFeedback() {
            const comments = document.getElementById('feedback-comments')?.value || '';
            
            if (comments.trim() === '') {
                showNotification('Please provide some comments before submitting feedback.', 'error');
                return;
            }
            
            showNotification('Thank you for your feedback! Your response has been recorded.', 'info');
            
            // Clear feedback form
            if (document.getElementById('feedback-comments')) {
                document.getElementById('feedback-comments').value = '';
            }
            
            // Reset ratings
            document.querySelectorAll('.feedback-rating').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.feedback-rating[data-rating="5"]')?.classList.add('active');
        }

        // Feedback Ratings
        function initializeFeedbackRatings() {
            document.querySelectorAll('.feedback-rating').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.feedback-rating').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }

        // Simulation System
        function initializeSimulation() {
            console.log("Initializing simulation...");
            
            // DOM Elements for simulation
            const functionInput = document.getElementById('simulation-function');
            const expansionPointInput = document.getElementById('simulation-expansion-point');
            const powerInput = document.getElementById('simulation-power');
            const powerValue = document.getElementById('simulation-power-value');
            const xMinInput = document.getElementById('simulation-x-min');
            const xMaxInput = document.getElementById('simulation-x-max');
            const calculateBtn = document.getElementById('simulation-calculate-btn');
            const resetBtn = document.getElementById('simulation-reset-btn');
            const taylorResult = document.getElementById('simulation-taylor-result');
            const exampleBtns = document.querySelectorAll('.simulation-example-btn');
            const originalValueSpan = document.getElementById('simulation-original-value');
            const taylorValueSpan = document.getElementById('simulation-taylor-value');
            const differenceSpan = document.getElementById('simulation-difference');
            const xValueDisplay = document.getElementById('simulation-x-value-display');
            
            // Default values
            const DEFAULT_FUNCTION = 'sin(x)';
            const DEFAULT_POINT = 0;
            const DEFAULT_POWER = 5;
            const DEFAULT_X_MIN = -3;
            const DEFAULT_X_MAX = 3;
            
            // Track current functions
            let currentTaylorFunc = null;
            let currentOriginalFunc = null;
            
            // Initialize with default values
            function initializeSimulationValues() {
                functionInput.value = DEFAULT_FUNCTION;
                expansionPointInput.value = DEFAULT_POINT;
                powerInput.value = DEFAULT_POWER;
                powerValue.textContent = DEFAULT_POWER;
                xMinInput.value = DEFAULT_X_MIN;
                xMaxInput.value = DEFAULT_X_MAX;
                
                // Calculate and display initial result
                calculateTaylorExpansion();
            }
            
            // Update power value display
            powerInput.addEventListener('input', function() {
                powerValue.textContent = this.value;
            });
            
            // Reset to default values
            resetBtn.addEventListener('click', function() {
                initializeSimulationValues();
                showNotification('Reset to default values', 'info');
            });
            
            // Example button click handlers
            exampleBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const func = this.getAttribute('data-func');
                    const point = this.getAttribute('data-point');
                    const power = this.getAttribute('data-power');
                    const xmin = this.getAttribute('data-xmin');
                    const xmax = this.getAttribute('data-xmax');
                    
                    functionInput.value = func;
                    expansionPointInput.value = point;
                    powerInput.value = power;
                    powerValue.textContent = power;
                    xMinInput.value = xmin;
                    xMaxInput.value = xmax;
                    
                    calculateTaylorExpansion();
                    showNotification(`Loaded example: ${func}`, 'info');
                });
            });
            
            // Calculate Taylor expansion
            calculateBtn.addEventListener('click', calculateTaylorExpansion);
            
            // Main calculation function
            function calculateTaylorExpansion() {
                try {
                    // Get user inputs
                    const funcStr = functionInput.value.trim();
                    const a = parseFloat(expansionPointInput.value);
                    const n = parseInt(powerInput.value);
                    const xMin = parseFloat(xMinInput.value);
                    const xMax = parseFloat(xMaxInput.value);
                    
                    // Validate inputs
                    if (isNaN(a) || isNaN(n) || n < 0 || n > 10) {
                        throw new Error("Please enter valid values: a (any number), n (0-10)");
                    }
                    
                    if (xMin >= xMax) {
                        throw new Error("X Minimum must be less than X Maximum");
                    }
                    
                    // Create the user function
                    const userFunc = createFunction(funcStr);
                    currentOriginalFunc = userFunc;
                    
                    // Calculate derivatives and coefficients
                    const coefficients = [];
                    for (let k = 0; k <= n; k++) {
                        const derivative = numericalDerivative(userFunc, a, k);
                        coefficients.push(derivative / factorial(k));
                    }
                    
                    // Generate Taylor polynomial string
                    const polyStr = generateTaylorPolynomialString(coefficients, a);
                    taylorResult.innerHTML = `\\[T_{${n}}(x) = ${polyStr}\\]`;
                    
                    // Render MathJax
                    MathJax.typesetPromise([taylorResult]).catch(err => {
                        console.error("MathJax rendering error:", err);
                        taylorResult.textContent = `T_${n}(x) = ${polyStr}`;
                    });
                    
                    // Create Taylor function
                    const taylorFunc = createTaylorFunction(coefficients, a);
                    currentTaylorFunc = taylorFunc;
                    
                    // Generate plot data
                    const plotData = generatePlotData(userFunc, taylorFunc, xMin, xMax, a);
                    
                    // Create plot
                    createPlot(plotData, funcStr, a, n);
                    
                    // Update value comparison
                    updateValueComparison(userFunc, taylorFunc, a);
                    
                    showNotification('Taylor polynomial calculated successfully!', 'info');
                    
                } catch (error) {
                    showNotification(`Error: ${error.message}`, 'error');
                    console.error(error);
                }
            }
            
            // Helper functions for simulation
            function createFunction(funcStr) {
                let processedStr = funcStr
                    .replace(/\^/g, '**')
                    .replace(/sin\(/g, 'Math.sin(')
                    .replace(/cos\(/g, 'Math.cos(')
                    .replace(/tan\(/g, 'Math.tan(')
                    .replace(/exp\(/g, 'Math.exp(')
                    .replace(/log\(/g, 'Math.log(')
                    .replace(/sqrt\(/g, 'Math.sqrt(')
                    .replace(/abs\(/g, 'Math.abs(');
                
                // Handle special case for 1/(1-x)
                if (funcStr.includes('1/(1-x)') || funcStr.includes('1/(1 - x)')) {
                    return function(x) {
                        return 1 / (1 - x);
                    };
                }
                
                try {
                    const testFn = new Function('x', `
                        try {
                            return ${processedStr};
                        } catch(e) {
                            return NaN;
                        }
                    `);
                    
                    const testResult = testFn(0);
                    if (isNaN(testResult) && !funcStr.includes('log(0)') && !funcStr.includes('sqrt(-')) {
                        throw new Error("Function returns NaN at x=0");
                    }
                    return testFn;
                } catch (error) {
                    throw new Error(`Invalid function: ${funcStr}. Use JavaScript math syntax.`);
                }
            }
            
            function factorial(n) {
                if (n === 0 || n === 1) return 1;
                let result = 1;
                for (let i = 2; i <= n; i++) {
                    result *= i;
                }
                return result;
            }
            
            function numericalDerivative(f, x, order) {
                if (order === 0) return f(x);
                
                const h = 1e-4;
                if (order === 1) {
                    return (f(x + h) - f(x - h)) / (2 * h);
                } else {
                    const f1 = numericalDerivative(f, x + h, order - 1);
                    const f2 = numericalDerivative(f, x - h, order - 1);
                    return (f1 - f2) / (2 * h);
                }
            }
            
            function generateTaylorPolynomialString(coefficients, a) {
                let terms = [];
                
                for (let k = 0; k < coefficients.length; k++) {
                    const coeff = coefficients[k];
                    
                    if (Math.abs(coeff) < 1e-10 && k !== 0) continue;
                    
                    let coeffStr;
                    if (Math.abs(coeff) < 1e-10) {
                        if (k === 0) coeffStr = "0";
                        else continue;
                    } else if (Math.abs(coeff - 1) < 1e-10 && k !== 0) {
                        coeffStr = "";
                    } else if (Math.abs(coeff + 1) < 1e-10 && k !== 0) {
                        coeffStr = "-";
                    } else {
                        const rounded = Math.round(coeff * 100000) / 100000;
                        const absRounded = Math.abs(rounded);
                        
                        // Check for common fractions
                        if (Math.abs(absRounded - 1/6) < 1e-6) coeffStr = (coeff < 0 ? '-' : '') + '\\frac{1}{6}';
                        else if (Math.abs(absRounded - 1/2) < 1e-6) coeffStr = (coeff < 0 ? '-' : '') + '\\frac{1}{2}';
                        else if (Math.abs(absRounded - 1/3) < 1e-6) coeffStr = (coeff < 0 ? '-' : '') + '\\frac{1}{3}';
                        else if (Math.abs(absRounded - 1/4) < 1e-6) coeffStr = (coeff < 0 ? '-' : '') + '\\frac{1}{4}';
                        else if (Math.abs(absRounded - 1/24) < 1e-6) coeffStr = (coeff < 0 ? '-' : '') + '\\frac{1}{24}';
                        else if (Math.abs(absRounded - 1/120) < 1e-6) coeffStr = (coeff < 0 ? '-' : '') + '\\frac{1}{120}';
                        else {
                            coeffStr = rounded.toString();
                            coeffStr = coeffStr.replace(/(\.\d*?[1-9])0+$/, "$1").replace(/\.$/, "");
                        }
                    }
                    
                    let termStr;
                    if (k === 0) {
                        termStr = coeffStr;
                    } else {
                        const xTerm = a === 0 ? 'x' : `(x - ${a})`;
                        const powerStr = k === 1 ? xTerm : `${xTerm}^{${k}}`;
                        
                        if (coeffStr === "" || coeffStr === "-") {
                            termStr = `${coeffStr}${powerStr}`;
                        } else {
                            termStr = `${coeffStr} \\cdot ${powerStr}`;
                        }
                    }
                    
                    if (k > 0 && coeff > 0 && terms.length > 0) {
                        termStr = `+ ${termStr}`;
                    }
                    
                    terms.push(termStr);
                }
                
                if (terms.length === 0) return "0";
                
                return terms.join(' ');
            }
            
            function createTaylorFunction(coefficients, a) {
                return function(x) {
                    let result = 0;
                    for (let k = 0; k < coefficients.length; k++) {
                        result += coefficients[k] * Math.pow(x - a, k);
                    }
                    return result;
                };
            }
            
            function generatePlotData(originalFunc, taylorFunc, xMin, xMax, a) {
                const data = {
                    x: [],
                    yOriginal: [],
                    yTaylor: [],
                    yError: []
                };
                
                const numPoints = 300;
                const step = (xMax - xMin) / numPoints;
                
                for (let i = 0; i <= numPoints; i++) {
                    const x = xMin + i * step;
                    const yOrig = originalFunc(x);
                    const yTaylor = taylorFunc(x);
                    
                    if (isFinite(yOrig) && isFinite(yTaylor)) {
                        data.x.push(x);
                        data.yOriginal.push(yOrig);
                        data.yTaylor.push(yTaylor);
                        data.yError.push(Math.abs(yOrig - yTaylor));
                    }
                }
                
                return data;
            }
            
            function createPlot(data, funcStr, a, n) {
                const graphDiv = document.getElementById('simulation-graph');
                
                // Clear previous plot
                while (graphDiv.firstChild) {
                    graphDiv.removeChild(graphDiv.firstChild);
                }
                
                // Original function trace
                const trace1 = {
                    x: data.x,
                    y: data.yOriginal,
                    mode: 'lines',
                    name: `f(x) = ${funcStr}`,
                    line: {
                        color: '#3498db',
                        width: 3
                    }
                };
                
                // Taylor polynomial trace
                const trace2 = {
                    x: data.x,
                    y: data.yTaylor,
                    mode: 'lines',
                    name: `T${n}(x) (Taylor)`,
                    line: {
                        color: '#e74c3c',
                        width: 2,
                        dash: 'dash'
                    }
                };
                
                // Error trace
                const trace3 = {
                    x: data.x,
                    y: data.yError,
                    mode: 'lines',
                    name: 'Error |f(x) - T(x)|',
                    line: {
                        color: '#2ecc71',
                        width: 1.5,
                        opacity: 0.6
                    },
                    yaxis: 'y2'
                };
                
                // Expansion point marker
                const originalY = createFunction(funcStr)(a);
                const trace4 = {
                    x: [a],
                    y: [originalY],
                    mode: 'markers+text',
                    name: `Expansion point (${a}, ${originalY.toFixed(3)})`,
                    marker: {
                        color: '#f39c12',
                        size: 12,
                        symbol: 'star'
                    },
                    text: [`a=${a}`],
                    textposition: 'top right'
                };
                
                const plotData = [trace1, trace2, trace3, trace4];
                
                const layout = {
                    title: {
                        text: `Taylor Approximation: f(x) vs T${n}(x)`,
                        font: { size: 16 }
                    },
                    xaxis: {
                        title: 'x',
                        gridcolor: '#e1e8f0'
                    },
                    yaxis: {
                        title: 'Function Value',
                        gridcolor: '#e1e8f0'
                    },
                    yaxis2: {
                        title: 'Error',
                        overlaying: 'y',
                        side: 'right',
                        gridcolor: 'rgba(46, 204, 113, 0.2)'
                    },
                    hovermode: 'closest',
                    showlegend: true,
                    legend: {
                        x: 0.02,
                        y: 0.98,
                        bgcolor: 'rgba(255, 255, 255, 0.9)'
                    },
                    plot_bgcolor: 'white',
                    margin: { t: 50, r: 50, b: 50, l: 50 }
                };
                
                const config = {
                    responsive: true,
                    displayModeBar: true
                };
                
                Plotly.newPlot(graphDiv, plotData, layout, config);
                
                // Add click event to graph
                graphDiv.on('plotly_click', function(eventData) {
                    if (eventData.points && eventData.points[0]) {
                        const x = eventData.points[0].x;
                        updateValueComparison(currentOriginalFunc, currentTaylorFunc, x);
                    }
                });
            }
            
            function updateValueComparison(originalFunc, taylorFunc, x) {
                xValueDisplay.textContent = x.toFixed(3);
                
                const originalVal = originalFunc(x);
                const taylorVal = taylorFunc(x);
                const diff = Math.abs(originalVal - taylorVal);
                
                originalValueSpan.textContent = isFinite(originalVal) ? originalVal.toFixed(4) : "undefined";
                taylorValueSpan.textContent = isFinite(taylorVal) ? taylorVal.toFixed(4) : "undefined";
                differenceSpan.textContent = isFinite(diff) ? diff.toFixed(6) : "undefined";
                
                if (diff < 0.001) {
                    differenceSpan.style.color = '#2ecc71';
                } else if (diff < 0.1) {
                    differenceSpan.style.color = '#f39c12';
                } else {
                    differenceSpan.style.color = '#e74c3c';
                }
            }
            
            // Initialize simulation values
            initializeSimulationValues();
        }
    </script>
</body>
</html>